it should render the application manifests:
  1: |
    apiVersion: helm.toolkit.fluxcd.io/v2
    kind: HelmRelease
    metadata:
      name: account-operator
      namespace: default
    spec:
      chartRef:
        kind: OCIRepository
        name: account-operator
        namespace: default
      dependsOn: null
      interval: 1m
      releaseName: account-operator
      targetNamespace: platform-mesh-system
      timeout: 30m
      values:
        crds:
          enabled: false
        kcp:
          apiExportEndpointSliceName: ""
          enabled: true
        kubeconfigSecret: account-operator-kubeconfig
        log:
          level: debug
        subroutines:
          fga:
            grpcAddr: openfga:8081
        tracing:
          collector:
            host: observability-opentelemetry-collector.observability.svc.cluster.local:4317
          enabled: false
  2: |
    apiVersion: helm.toolkit.fluxcd.io/v2
    kind: HelmRelease
    metadata:
      name: extension-manager-operator
      namespace: default
    spec:
      chartRef:
        kind: OCIRepository
        name: extension-manager-operator
        namespace: default
      dependsOn: null
      interval: 1m
      releaseName: extension-manager-operator
      targetNamespace: platform-mesh-system
      timeout: 30m
      values:
        crds:
          enabled: false
        kcp:
          enabled: true
          kubeconfigSecret: extension-manager-operator-kubeconfig
        tracing:
          collector:
            host: observability-opentelemetry-collector.observability.svc.cluster.local:4317
          enabled: false
  3: |
    apiVersion: helm.toolkit.fluxcd.io/v2
    kind: HelmRelease
    metadata:
      name: iam-service
      namespace: default
    spec:
      chartRef:
        kind: OCIRepository
        name: iam-service
        namespace: default
      dependsOn: null
      interval: 1m
      releaseName: iam-service
      targetNamespace: platform-mesh-system
      timeout: 30m
      values:
        caSecret: domain-certificate-ca
  4: |
    apiVersion: helm.toolkit.fluxcd.io/v2
    kind: HelmRelease
    metadata:
      name: iam-ui
      namespace: default
    spec:
      chartRef:
        kind: OCIRepository
        name: iam-ui
        namespace: default
      dependsOn: null
      interval: 1m
      releaseName: iam-ui
      targetNamespace: platform-mesh-system
      timeout: 30m
      values: null
  5: |
    apiVersion: helm.toolkit.fluxcd.io/v2
    kind: HelmRelease
    metadata:
      name: infra
      namespace: default
    spec:
      chartRef:
        kind: OCIRepository
        name: infra
        namespace: default
      dependsOn:
        - name: kcp-operator
          namespace: default
      interval: 1m
      releaseName: infra
      targetNamespace: platform-mesh-system
      timeout: 30m
      values:
        gatewayApi:
          enabled: true
        istio:
          main:
            gateway:
              hosts:
                - example.com
                - '*.example.com'
              name: https
              port: "8443"
              protocol: HTTPS
              tls:
                credentialName: domain-certificate
                minProtocolVersion: TLSV1_2
                mode: SIMPLE
          passThrough:
            gateway:
              enabled: true
              hosts:
                - kcp.api.example.com
              name: pass-https
              port: "8443"
              protocol: HTTPS
        kcp:
          image:
            tag: v0.29.0
          rootShard:
            extraArgs:
              - --feature-gates=WorkspaceAuthentication=true
              - --shard-virtual-workspace-url=https://localhost:8443
          webhook:
            enabled: true
        keycloak:
          istio:
            virtualservice:
              hosts:
                - example.com
  6: |
    apiVersion: helm.toolkit.fluxcd.io/v2
    kind: HelmRelease
    metadata:
      name: keycloak
      namespace: default
    spec:
      chartRef:
        kind: OCIRepository
        name: keycloak
        namespace: default
      dependsOn: null
      interval: 1m
      releaseName: keycloak
      targetNamespace: platform-mesh-system
      timeout: 30m
      values:
        auth:
          adminUser: keycloak-admin
          existingSecret: keycloak-admin
          passwordSecretKey: secret
        extraEnvVars:
          - name: JAVA_OPTS_APPEND
            value: -Djgroups.dns.query=keycloak-headless.platform-mesh-system.svc.cluster.local
          - name: KC_PROXY_HEADERS
            value: xforwarded
          - name: KC_HOSTNAME_STRICT
            value: "false"
        global:
          imagePullSecrets:
            - name: github
          security:
            allowInsecureImages: true
        httpRelativePath: /keycloak/
        image:
          registry: ghcr.io/platform-mesh
          repository: upstream-images/keycloak
        postgresql:
          auth:
            existingSecret: ""
            secretKeys:
              adminPasswordKey: password
              userPasswordKey: password
            username: keycloak
          image:
            registry: ghcr.io/platform-mesh
            repository: upstream-images/postgresql
            tag: 17.6.0-debian-12-r4
          nameOverride: postgresql-keycloak
          primary:
            resourcesPreset: none
        resources:
          limits:
            cpu: "2"
            ephemeral-storage: 2Gi
            memory: 2Gi
          requests:
            cpu: 750m
            ephemeral-storage: 50Mi
            memory: 1Gi
  7: |
    apiVersion: helm.toolkit.fluxcd.io/v2
    kind: HelmRelease
    metadata:
      name: kubernetes-graphql-gateway
      namespace: default
    spec:
      chartRef:
        kind: OCIRepository
        name: kubernetes-graphql-gateway
        namespace: default
      dependsOn: null
      interval: 1m
      releaseName: kubernetes-graphql-gateway
      targetNamespace: platform-mesh-system
      timeout: 30m
      values:
        cors:
          enabled: true
        gatewayApi:
          enabled: true
        kubeConfig:
          enabled: true
          secretName: kubernetes-grapqhl-gateway-kubeconfig
        listener:
          virtualWorkspacesConfig:
            content:
              virtualWorkspaces:
                - kubeconfig: /app/kubeconfig/kubeconfig
                  name: contentconfigurations
                  url: https://frontproxy-front-proxy.platform-mesh-system:6443/services/contentconfigurations
                - kubeconfig: /app/kubeconfig/kubeconfig
                  name: marketplace
                  url: https://frontproxy-front-proxy.platform-mesh-system:6443/services/marketplace
            enabled: true
        tracing:
          enabled: false
        trust:
          default:
            audience: default
            jwksUrl: http://keycloak-headless.platform-mesh-system:8080/keycloak/realms/default/protocol/openid-connect/certs
            trustedIssuer: https://example.com:8443/keycloak/realms/default
        virtualService:
          hosts:
            - example.com
            - '*.example.com'
          httpRules:
            - cors:
                allowHeaders:
                  - '*'
                allowMethods:
                  - GET
                  - POST
                allowOrigins:
                  - regex: .*
              name: default
          pathPrefix: /api/kubernetes-graphql-gateway/
  8: |
    apiVersion: helm.toolkit.fluxcd.io/v2
    kind: HelmRelease
    metadata:
      name: openfga
      namespace: default
    spec:
      chart:
        spec:
          chart: openfga
          reconcileStrategy: ChartVersion
          sourceRef:
            kind: HelmRepository
            name: openfga
      dependsOn: null
      interval: 1m
      releaseName: openfga
      targetNamespace: platform-mesh-system
      timeout: 30m
      values:
        autoscaling:
          enabled: false
        checkQueryCache:
          enabled: true
          limit: 10000
          ttl: 10s
        datastore:
          applyMigrations: true
          engine: postgres
          maxOpenConns: 30
          migrationType: initContainer
          migrations:
            image:
              pullPolicy: Always
              repository: groundnuty/k8s-wait-for
              tag: v2.0
        extraEnvVars:
          - name: OPENFGA_EXPERIMENTALS
            value: enable-list-users
        global:
          imagePullSecrets:
            - name: github
        image:
          repository: openfga/openfga
          tag: ""
        log:
          level: info
        migrate:
          annotations:
            sidecar.istio.io/inject: "false"
        podAnnotations:
          traffic.sidecar.istio.io/excludeInboundPorts: "2112"
        postgresql:
          enabled: true
          image:
            registry: ghcr.io/platform-mesh
            repository: images/postgresql
          nameOverride: postgres
        replicaCount: 1
        telemetry:
          trace:
            enabled: false
            otlp:
              endpoint: observability-opentelemetry-collector.observability.svc.cluster.local:4317
              tls:
                enabled: false
  9: |
    apiVersion: helm.toolkit.fluxcd.io/v2
    kind: HelmRelease
    metadata:
      name: rebac-authz-webhook
      namespace: default
    spec:
      chartRef:
        kind: OCIRepository
        name: rebac-authz-webhook
        namespace: default
      dependsOn: null
      interval: 1m
      releaseName: rebac-authz-webhook
      targetNamespace: platform-mesh-system
      timeout: 30m
      values:
        certManager:
          createCA: true
          enabled: true
        log:
          level: debug
        openfga:
          url: openfga:8081
  10: |
    apiVersion: helm.toolkit.fluxcd.io/v2
    kind: HelmRelease
    metadata:
      name: security-operator
      namespace: default
    spec:
      chartRef:
        kind: OCIRepository
        name: security-operator
        namespace: default
      dependsOn: null
      interval: 1m
      releaseName: security-operator
      targetNamespace: platform-mesh-system
      timeout: 30m
      values:
        baseDomain: example.com:8443
        crds:
          enabled: false
        fga:
          inviteKeycloakBaseUrl: https://example.com:8443/keycloak
          target: openfga.platform-mesh-system.svc.cluster.local:8081
        initializer:
          kubeconfigSecret: security-initializer-kubeconfig
        kubeconfigSecret: security-operator-kubeconfig
        log:
          level: debug
        operator:
          maxConcurrentReconciles: 1
          shutdownTimeout: 1m
  11: |
    apiVersion: helm.toolkit.fluxcd.io/v2
    kind: HelmRelease
    metadata:
      name: virtual-workspaces
      namespace: default
    spec:
      chartRef:
        kind: OCIRepository
        name: virtual-workspaces
        namespace: default
      dependsOn: null
      interval: 1m
      releaseName: virtual-workspaces
      targetNamespace: platform-mesh-system
      timeout: 30m
      values:
        deployment:
          resourceSchemaName: v250704-6d57f16.contentconfigurations.ui.platform-mesh.io
          resourceSchemaWorkspace: root:platform-mesh-system
          serverUrl: https://frontproxy-front-proxy.platform-mesh-system:6443
        virtualWorkspaceSecretName: virtual-workspaces-cert
  12: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      annotations:
        artifact: image
        for: account-operator
        repo: oci
      name: account-operator-image
    spec:
      componentRef:
        name: platform-mesh
      interval: 1m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: test
            - name: account-operator
          resource:
            name: image
  13: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      annotations:
        artifact: image
        for: extension-manager-operator
        repo: oci
      name: extension-manager-operator-image
    spec:
      componentRef:
        name: platform-mesh
      interval: 1m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: test
            - name: extension-manager-operator
          resource:
            name: image
  14: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      annotations:
        artifact: image
        for: iam-service
        repo: oci
      name: iam-service-image
    spec:
      componentRef:
        name: platform-mesh
      interval: 1m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: test
            - name: iam-service
          resource:
            name: image
  15: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      annotations:
        artifact: image
        for: iam-ui
        repo: oci
      name: iam-ui-image
    spec:
      componentRef:
        name: platform-mesh
      interval: 1m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: test
            - name: iam-ui
          resource:
            name: image
  16: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      annotations:
        artifact: image
        for: infra
        path: kcp.image.tag
        repo: oci
      name: kcp-image
    spec:
      componentRef:
        name: platform-mesh
      interval: 1m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: kcp
          resource:
            name: image
  17: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      annotations:
        artifact: image
        for: kubernetes-graphql-gateway
        repo: oci
      name: kubernetes-graphql-gateway-image
    spec:
      componentRef:
        name: platform-mesh
      interval: 1m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: test
            - name: kubernetes-graphql-gateway
          resource:
            name: image
  18: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      annotations:
        artifact: image
        for: openfga
        repo: oci
      name: openfga-image
    spec:
      componentRef:
        name: platform-mesh
      interval: 1m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: test
            - name: openfga
          resource:
            name: image
  19: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      annotations:
        artifact: image
        for: openfga
        path: postgresql.image.tag
        repo: oci
      name: openfga-postgresql-image
    spec:
      componentRef:
        name: platform-mesh
      interval: 1m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: test
            - name: openfga
          resource:
            name: postgresql-image
  20: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      annotations:
        artifact: image
        for: rebac-authz-webhook
        repo: oci
      name: rebac-authz-webhook-image
    spec:
      componentRef:
        name: platform-mesh
      interval: 1m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: test
            - name: rebac-authz-webhook
          resource:
            name: image
  21: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      annotations:
        artifact: image
        for: security-operator
        repo: oci
      name: security-operator-image
    spec:
      componentRef:
        name: platform-mesh
      interval: 1m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: test
            - name: security-operator
          resource:
            name: image
  22: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      annotations:
        artifact: image
        for: virtual-workspaces
        repo: oci
      name: virtual-workspaces-image
    spec:
      componentRef:
        name: platform-mesh
      interval: 1m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: test
            - name: virtual-workspaces
          resource:
            name: image
  23: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      labels:
        artifact: chart
        repo: oci
      name: account-operator
    spec:
      componentRef:
        name: platform-mesh
      interval: 3m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: test
            - name: account-operator
          resource:
            name: chart
      skipVerify: true
  24: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      labels:
        artifact: chart
        repo: oci
      name: extension-manager-operator
    spec:
      componentRef:
        name: platform-mesh
      interval: 3m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: test
            - name: extension-manager-operator
          resource:
            name: chart
      skipVerify: true
  25: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      labels:
        artifact: chart
        repo: oci
      name: iam-service
    spec:
      componentRef:
        name: platform-mesh
      interval: 3m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: test
            - name: iam-service
          resource:
            name: chart
      skipVerify: true
  26: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      labels:
        artifact: chart
        repo: oci
      name: iam-ui
    spec:
      componentRef:
        name: platform-mesh
      interval: 3m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: test
            - name: iam-ui
          resource:
            name: chart
      skipVerify: true
  27: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      labels:
        artifact: chart
        repo: oci
      name: infra
    spec:
      componentRef:
        name: platform-mesh
      interval: 3m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: test
            - name: infra
          resource:
            name: chart
      skipVerify: true
  28: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      labels:
        artifact: chart
        repo: oci
      name: keycloak
    spec:
      componentRef:
        name: platform-mesh
      interval: 3m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: test
            - name: keycloak
          resource:
            name: chart
      skipVerify: true
  29: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      labels:
        artifact: chart
        repo: oci
      name: kubernetes-graphql-gateway
    spec:
      componentRef:
        name: platform-mesh
      interval: 3m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: test
            - name: kubernetes-graphql-gateway
          resource:
            name: chart
      skipVerify: true
  30: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      labels:
        artifact: chart
        repo: helm
      name: openfga
    spec:
      componentRef:
        name: platform-mesh
      interval: 3m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: test
            - name: openfga
          resource:
            name: chart
      skipVerify: true
  31: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      labels:
        artifact: chart
        repo: oci
      name: organization-idp
    spec:
      componentRef:
        name: platform-mesh
      interval: 3m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: test
            - name: organization-idp
          resource:
            name: chart
      skipVerify: true
  32: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      labels:
        artifact: chart
        repo: oci
      name: rebac-authz-webhook
    spec:
      componentRef:
        name: platform-mesh
      interval: 3m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: test
            - name: rebac-authz-webhook
          resource:
            name: chart
      skipVerify: true
  33: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      labels:
        artifact: chart
        repo: oci
      name: security-operator
    spec:
      componentRef:
        name: platform-mesh
      interval: 3m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: test
            - name: security-operator
          resource:
            name: chart
      skipVerify: true
  34: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      labels:
        artifact: chart
        repo: oci
      name: virtual-workspaces
    spec:
      componentRef:
        name: platform-mesh
      interval: 3m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: test
            - name: virtual-workspaces
          resource:
            name: chart
      skipVerify: true
