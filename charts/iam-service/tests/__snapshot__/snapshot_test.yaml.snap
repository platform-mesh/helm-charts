match the snapshots:
  1: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: iam-service
      name: iam-service
      namespace: platform-mesh-system
    spec:
      selector:
        matchLabels:
          app: iam-service
      template:
        metadata:
          labels:
            app: iam-service
        spec:
          containers:
            - args:
                - serve
                - --keycloak-base-url=https://portal.localhost:8443/keycloak
                - --keycloak-client-id=iam-service
                - --roles-file-path=/roles/roles.yaml
                - --jwt-user-id-claim=email
                - --test=abc
              env:
                - name: KUBECONFIG
                  value: /api-kubeconfig/kubeconfig
                - name: KEYCLOAK_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: iam-client-secret
              image: ghcr.io/platform-mesh/iam-service:12345
              imagePullPolicy: IfNotPresent
              livenessProbe:
                failureThreshold: 1
                httpGet:
                  path: /healthz
                  port: 8080
                periodSeconds: 10
              name: iam-service
              ports:
                - containerPort: 8080
                  name: http
                  protocol: TCP
              readinessProbe:
                httpGet:
                  path: /readyz
                  port: 8080
                initialDelaySeconds: 5
                periodSeconds: 10
              startupProbe:
                failureThreshold: 30
                httpGet:
                  path: /readyz
                  port: 8080
                periodSeconds: 10
              volumeMounts:
                - mountPath: /api-kubeconfig
                  name: external-api-server
                - mountPath: /roles
                  name: roles
          hostAliases:
            - hostnames:
                - portal.localhost
                - localhost
              ip: 10.96.188.4
          imagePullSecrets:
            - name: github
          serviceAccountName: iam-service
          volumes:
            - name: external-api-server
              secret:
                secretName: iam-service-kubeconfig
            - configMap:
                name: iam-service-roles
              name: roles
  2: |
    apiVersion: gateway.networking.k8s.io/v1
    kind: HTTPRoute
    metadata:
      name: iam-service
    spec:
      hostnames:
        - portal.localhost
        - '*.portal.localhost'
      parentRefs:
        - name: k8sapi-gateway
      rules:
        - backendRefs:
            - name: iam-service
              namespace: platform-mesh-system
              port: 8080
          filters:
            - type: URLRewrite
              urlRewrite:
                path:
                  replacePrefixMatch: /graphql
                  type: ReplacePrefixMatch
            - extensionRef:
                group: traefik.io
                kind: Middleware
                name: cors-header
              type: ExtensionRef
          matches:
            - path:
                type: PathPrefix
                value: /iam/graphql
  3: |
    apiVersion: v1
    data:
      roles.yaml: |
        roles:
        - groupResource: core.platform-mesh.io/Account
          roles:
          - description: Full access to all resources within the account.
            displayName: Owner
            id: owner
          - description: Limited access to resources within the account. Can view and interact
              with resources but cannot administrate them.
            displayName: Member
            id: member
        - groupResource: Namespace
          roles:
          - description: Full access to all resources within the account.
            displayName: Owner
            id: owner
          - description: Limited access to resources within the account. Can view and interact
              with resources but cannot administrate them.
            displayName: Member
            id: member
    kind: ConfigMap
    metadata:
      labels:
        app: iam-service
      name: iam-service-roles
  4: |
    apiVersion: v1
    imagePullSecrets:
      - name: github
    kind: ServiceAccount
    metadata:
      name: iam-service
      namespace: platform-mesh-system
  5: |
    apiVersion: v1
    kind: Service
    metadata:
      labels:
        dxp.sap.com/metrics: enabled
      name: iam-service
      namespace: platform-mesh-system
    spec:
      ports:
        - name: http
          port: 8080
          protocol: TCP
      selector:
        app: iam-service
      type: ClusterIP
