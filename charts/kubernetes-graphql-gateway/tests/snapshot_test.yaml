suite: Test the Template files
values:
- ../values.yaml
release:
  name: platform-mesh
  namespace: platform-mesh-system
chart:
  appVersion: 1.0.0
templates:
  - deploy.yaml
tests:
  - it: match the Snapshot
    asserts:
    - matchSnapshot: {}
  - it: match the Snapshot with crds
    set:
      crds.enabled: true
    asserts:
    - matchSnapshot: {}
  - it: has all health checks
    template: deploy.yaml
    asserts:
      - equal:
          path: spec.template.spec.containers[0].livenessProbe.httpGet.path
          value: /healthz
      - equal:
          path: spec.template.spec.containers[0].readinessProbe.httpGet.path
          value: /readyz
      - equal:
          path: spec.template.spec.containers[0].startupProbe.httpGet.path
          value: /readyz
