apiVersion: networking.istio.io/v1
kind: VirtualService
metadata:
  name: keycloak
  namespace: platform-mesh-system
spec:
  gateways:
  - platform-mesh-system/gateway
  hosts:
  - portal.dev.local
  http:
  - headers:
      request:
        set:
          x-forwarded-port: "8443"
          x-forwarded-proto: https
    match:
    - uri:
        prefix: /keycloak
    route:
    - destination:
        host: keycloak-service.platform-mesh-system.svc.cluster.local
        port:
          number: 8080
