apiVersion: operator.kcp.io/v1alpha1
kind: FrontProxy
metadata:
  name: {{.Values.kcp.frontProxy.name }}
  namespace: {{ .Values.kcp.namespace | default "kcp-system" }}
spec:
  auth:
    {{- if .Values.kcp.oidc.enabled }}
    {{ with .Values.kcp.oidc }}
    oidc:
      enabled: true
      issuerURL: {{ .issuerUrl }}
      clientID: {{ .clientID }}
      groupsClaim: {{ .groupsClaim }}
      usernameClaim: {{ .usernameClaim }}
    {{- end }}
    {{- end }}

  additionalPathMappings:
{{ toYaml .Values.kcp.frontProxy.additionalPathMappings | indent 4 }}
  rootShard:
    ref:
      name: root
  serviceTemplate:
    spec:
      type: ClusterIP
  {{- if .Values.hostAliases.enabled }}
  {{- with .Values.hostAliases.entries }}
  deploymentTemplate:
    spec:
      template:
        spec:
          hostAliases:
            {{ toYaml . | nindent 12 }}
  {{- end }}
  {{- end }}