suite: Test service-mesh manifests
templates:
  - keycloak/httproute.yaml
  - gatewayapi/gateway.yaml
release:
  name: infra
  namespace: platform-mesh-system
tests:
- it: test HTTPRoutes
  templates: 
  - keycloak/httproute.yaml
  set:
    gatewayApi:
      enabled: true
    cors:
      enabled: true
  asserts:
  - matchSnapshot: {}
- it: configure Gateway infrastructure
  templates: 
  - gatewayapi/gateway.yaml
  set:
    gatewayApi:
      enabled: true
      main:
        gateway:
          infrastructure:
            annotations:
              dns.gardener.cloud/class: garden
  asserts:
  - equal:
      path: spec.infrastructure.annotations
      value:
        dns.gardener.cloud/class: garden