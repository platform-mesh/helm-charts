match snapshots:
  1: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      name: infra-mailpit
    spec:
      revisionHistoryLimit: 3
      selector:
        matchLabels:
          app: infra-mailpit
      strategy:
        rollingUpdate:
          maxSurge: 5
          maxUnavailable: 0
        type: RollingUpdate
      template:
        metadata:
          labels:
            app: infra-mailpit
        spec:
          containers:
            - args:
                - --webroot=/mailpit
                - --smtp-auth-accept-any
                - --smtp-auth-allow-insecure
              image: axllent/mailpit:v1.27.9
              imagePullPolicy: IfNotPresent
              name: infra-mailpit
              ports:
                - containerPort: 8025
                  name: ui
                  protocol: TCP
                - containerPort: 1025
                  name: smtp
                  protocol: TCP
              resources:
                limits:
                  memory: 512Mi
                requests:
                  cpu: 40m
                  memory: 50Mi
          hostAliases: null
  2: |
    apiVersion: v1
    kind: Service
    metadata:
      labels:
        app: infra-mailpit
      name: infra-mailpit
    spec:
      ports:
        - name: ui
          port: 8025
          protocol: TCP
          targetPort: ui
        - appProtocol: tcp
          name: smtp
          port: 1025
          protocol: TCP
          targetPort: smtp
      selector:
        app: infra-mailpit
  3: |
    apiVersion: networking.istio.io/v1beta1
    kind: VirtualService
    metadata:
      name: mailpit
    spec:
      gateways:
        - platform-mesh-system/gateway
      hosts:
        - portal.dev.local
      http:
        - match:
            - uri:
                prefix: /mailpit
          route:
            - destination:
                host: mailpit.platform-mesh-system.svc.cluster.local
                port:
                  number: 8025
