FluxCD enable remote deployment:
  1: |
    apiVersion: helm.toolkit.fluxcd.io/v2
    kind: HelmRelease
    metadata:
      name: cert-manager
    spec:
      chartRef:
        kind: OCIRepository
        name: cert-manager
        namespace: default
      install:
        createNamespace: true
      interval: 1m
      kubeConfig:
        secretRef:
          key: kubeconfig
          name: test-kubeconfig-secret
      releaseName: cert-manager
      targetNamespace: cert-manager
      timeout: 30m
      values:
        crds:
          enabled: true
  2: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      annotations:
        artifact: image
        for: cert-manager
        path: cainjector.image.tag
        repo: oci
      name: cert-manager-cainjector-image
    spec:
      componentRef:
        name: platform-mesh
      interval: 3m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: cert-manager
          resource:
            name: cainjector-image
      skipVerify: true
  3: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      annotations:
        artifact: image
        for: cert-manager
        repo: oci
      name: cert-manager-controller-image
    spec:
      componentRef:
        name: platform-mesh
      interval: 3m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: cert-manager
          resource:
            name: controller-image
      skipVerify: true
  4: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      annotations:
        artifact: image
        for: cert-manager
        path: webhook.image.tag
        repo: oci
      name: cert-manager-webhook-image
    spec:
      componentRef:
        name: platform-mesh
      interval: 3m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: cert-manager
          resource:
            name: webhook-image
      skipVerify: true
  5: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      labels:
        artifact: chart
        repo: oci
      name: cert-manager
    spec:
      componentRef:
        name: platform-mesh
      interval: 3m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: cert-manager
          resource:
            name: chart
      skipVerify: true
  6: |
    apiVersion: helm.toolkit.fluxcd.io/v2
    kind: HelmRelease
    metadata:
      name: etcd-druid
    spec:
      chartRef:
        kind: OCIRepository
        name: etcd-druid
        namespace: default
      install:
        createNamespace: true
      interval: 1m
      kubeConfig:
        secretRef:
          key: kubeconfig
          name: test-kubeconfig-secret
      releaseName: etcd-druid
      targetNamespace: etcd-druid-system
      timeout: 30m
      values: null
  7: |
    apiVersion: v1
    data:
      .ocmconfig: |
        type: generic.config.ocm.software/v1
        configurations:
          - type: resolvers.config.ocm.software
            resolvers:
              - repository:
                  type: OCIRegistry/v1
                  baseUrl: europe-docker.pkg.dev
                  subPath: gardener-project/releases
                componentNamePattern: "github.com/gardener/*"
    kind: ConfigMap
    metadata:
      name: ocm-resolver-config
  8: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Repository
    metadata:
      name: gardener-releases
    spec:
      interval: 1m
      ocmConfig:
        - apiVersion: v1
          kind: ConfigMap
          name: ocm-resolver-config
          namespace: default
          policy: Propagate
      repositorySpec:
        baseUrl: europe-docker.pkg.dev/gardener-project/releases
        type: OCIRegistry
  9: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      annotations:
        artifact: image
        for: etcd-druid
        path: image.tag
        repo: oci
      name: etcd-druid-image
    spec:
      componentRef:
        name: platform-mesh
      interval: 3m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: gardener-releases
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: etcd-druid
          resource:
            name: etcd-druid
      skipVerify: true
  10: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      labels:
        artifact: chart
        repo: oci
      name: etcd-druid
    spec:
      componentRef:
        name: platform-mesh
      interval: 3m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: gardener-releases
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: etcd-druid
          resource:
            name: etcd-druid
            type: helmChart
      skipVerify: true
  11: |
    apiVersion: kustomize.toolkit.fluxcd.io/v1
    kind: Kustomization
    metadata:
      name: gateway-api
    spec:
      force: false
      install:
        crds: Skip
      interval: 1m
      kubeConfig:
        secretRef:
          key: kubeconfig
          name: test-kubeconfig-secret
      path: ./config/crd/experimental
      prune: true
      sourceRef:
        kind: GitRepository
        name: gateway-api
  12: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      labels:
        artifact: chart
        repo: git
      name: gateway-api
    spec:
      componentRef:
        name: platform-mesh
      interval: 3m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: gateway-api
          resource:
            name: crds
      skipVerify: true
  13: |
    apiVersion: helm.toolkit.fluxcd.io/v2
    kind: HelmRelease
    metadata:
      name: kcp-operator
    spec:
      chart:
        spec:
          chart: kcp-operator
          reconcileStrategy: ChartVersion
          sourceRef:
            kind: HelmRepository
            name: kcp-operator
      install:
        createNamespace: true
      interval: 1m
      kubeConfig:
        secretRef:
          key: kubeconfig
          name: test-kubeconfig-secret
      releaseName: kcp-operator
      targetNamespace: kcp-operator
      timeout: 30m
      values: null
  14: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      annotations:
        artifact: image
        for: kcp-operator
        path: image.tag
        repo: oci
      name: kcp-operator-image
    spec:
      componentRef:
        name: platform-mesh
      interval: 3m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: kcp-operator
          resource:
            name: image
      skipVerify: true
  15: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      labels:
        artifact: chart
        repo: helm
      name: kcp-operator
    spec:
      componentRef:
        name: platform-mesh
      interval: 3m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: kcp-operator
          resource:
            name: chart
      skipVerify: true
  16: |
    apiVersion: helm.toolkit.fluxcd.io/v2
    kind: HelmRelease
    metadata:
      name: traefik-crds
    spec:
      chart:
        spec:
          chart: traefik-crds
          reconcileStrategy: ChartVersion
          sourceRef:
            kind: HelmRepository
            name: traefik-crds
      dependsOn: null
      interval: 1m
      kubeConfig:
        secretRef:
          key: kubeconfig
          name: test-kubeconfig-secret
      releaseName: traefik-crds
      targetNamespace: default
      timeout: 30m
  17: |
    apiVersion: helm.toolkit.fluxcd.io/v2
    kind: HelmRelease
    metadata:
      name: traefik
    spec:
      chart:
        spec:
          chart: traefik
          reconcileStrategy: ChartVersion
          sourceRef:
            kind: HelmRepository
            name: traefik
      dependsOn:
        - name: traefik-crds
      interval: 1m
      kubeConfig:
        secretRef:
          key: kubeconfig
          name: test-kubeconfig-secret
      releaseName: traefik
      targetNamespace: default
      timeout: 30m
      values:
        experimental:
          kubernetesGateway:
            enabled: true
        gateway:
          enabled: false
        gatewayClass:
          enabled: true
        ports:
          websecure:
            exposedPort: 8443
            nodePort: 31000
        providers:
          kubernetesGateway:
            enabled: true
            experimentalChannel: true
        service:
          spec:
            clusterIP: 10.96.188.4
          type: NodePort
  18: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      labels:
        artifact: chart
        repo: helm
      name: traefik-crds
    spec:
      componentRef:
        name: platform-mesh
      interval: 3m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: traefik
          resource:
            name: crds
      skipVerify: true
  19: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      annotations:
        artifact: image
        for: traefik
        repo: oci
      name: traefik-image
      namespace: default
    spec:
      componentRef:
        name: platform-mesh
      interval: 3m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: traefik
          resource:
            name: image
      skipVerify: true
  20: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      labels:
        artifact: chart
        repo: helm
      name: traefik
    spec:
      componentRef:
        name: platform-mesh
      interval: 3m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: traefik
          resource:
            name: chart
      skipVerify: true
FluxCD snapshots:
  1: |
    apiVersion: helm.toolkit.fluxcd.io/v2
    kind: HelmRelease
    metadata:
      name: cert-manager
    spec:
      chartRef:
        kind: OCIRepository
        name: cert-manager
        namespace: default
      install:
        createNamespace: true
      interval: 1m
      releaseName: cert-manager
      targetNamespace: cert-manager
      timeout: 30m
      values:
        crds:
          enabled: true
  2: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      annotations:
        artifact: image
        for: cert-manager
        path: cainjector.image.tag
        repo: oci
      name: cert-manager-cainjector-image
    spec:
      componentRef:
        name: platform-mesh
      interval: 3m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: cert-manager
          resource:
            name: cainjector-image
      skipVerify: true
  3: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      annotations:
        artifact: image
        for: cert-manager
        repo: oci
      name: cert-manager-controller-image
    spec:
      componentRef:
        name: platform-mesh
      interval: 3m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: cert-manager
          resource:
            name: controller-image
      skipVerify: true
  4: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      annotations:
        artifact: image
        for: cert-manager
        path: webhook.image.tag
        repo: oci
      name: cert-manager-webhook-image
    spec:
      componentRef:
        name: platform-mesh
      interval: 3m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: cert-manager
          resource:
            name: webhook-image
      skipVerify: true
  5: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      labels:
        artifact: chart
        repo: oci
      name: cert-manager
    spec:
      componentRef:
        name: platform-mesh
      interval: 3m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: cert-manager
          resource:
            name: chart
      skipVerify: true
  6: |
    apiVersion: helm.toolkit.fluxcd.io/v2
    kind: HelmRelease
    metadata:
      name: etcd-druid
    spec:
      chartRef:
        kind: OCIRepository
        name: etcd-druid
        namespace: default
      install:
        createNamespace: true
      interval: 1m
      releaseName: etcd-druid
      targetNamespace: etcd-druid-system
      timeout: 30m
      values: null
  7: |
    apiVersion: v1
    data:
      .ocmconfig: |
        type: generic.config.ocm.software/v1
        configurations:
          - type: resolvers.config.ocm.software
            resolvers:
              - repository:
                  type: OCIRegistry/v1
                  baseUrl: europe-docker.pkg.dev
                  subPath: gardener-project/releases
                componentNamePattern: "github.com/gardener/*"
    kind: ConfigMap
    metadata:
      name: ocm-resolver-config
  8: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Repository
    metadata:
      name: gardener-releases
    spec:
      interval: 1m
      ocmConfig:
        - apiVersion: v1
          kind: ConfigMap
          name: ocm-resolver-config
          namespace: default
          policy: Propagate
      repositorySpec:
        baseUrl: europe-docker.pkg.dev/gardener-project/releases
        type: OCIRegistry
  9: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      annotations:
        artifact: image
        for: etcd-druid
        path: image.tag
        repo: oci
      name: etcd-druid-image
    spec:
      componentRef:
        name: platform-mesh
      interval: 3m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: gardener-releases
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: etcd-druid
          resource:
            name: etcd-druid
      skipVerify: true
  10: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      labels:
        artifact: chart
        repo: oci
      name: etcd-druid
    spec:
      componentRef:
        name: platform-mesh
      interval: 3m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: gardener-releases
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: etcd-druid
          resource:
            name: etcd-druid
            type: helmChart
      skipVerify: true
  11: |
    apiVersion: kustomize.toolkit.fluxcd.io/v1
    kind: Kustomization
    metadata:
      name: gateway-api
    spec:
      force: false
      install:
        crds: Skip
      interval: 1m
      path: ./config/crd/experimental
      prune: true
      sourceRef:
        kind: GitRepository
        name: gateway-api
  12: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      labels:
        artifact: chart
        repo: git
      name: gateway-api
    spec:
      componentRef:
        name: platform-mesh
      interval: 3m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: gateway-api
          resource:
            name: crds
      skipVerify: true
  13: |
    apiVersion: helm.toolkit.fluxcd.io/v2
    kind: HelmRelease
    metadata:
      name: kcp-operator
    spec:
      chart:
        spec:
          chart: kcp-operator
          reconcileStrategy: ChartVersion
          sourceRef:
            kind: HelmRepository
            name: kcp-operator
      install:
        createNamespace: true
      interval: 1m
      releaseName: kcp-operator
      targetNamespace: kcp-operator
      timeout: 30m
      values: null
  14: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      annotations:
        artifact: image
        for: kcp-operator
        path: image.tag
        repo: oci
      name: kcp-operator-image
    spec:
      componentRef:
        name: platform-mesh
      interval: 3m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: kcp-operator
          resource:
            name: image
      skipVerify: true
  15: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      labels:
        artifact: chart
        repo: helm
      name: kcp-operator
    spec:
      componentRef:
        name: platform-mesh
      interval: 3m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: kcp-operator
          resource:
            name: chart
      skipVerify: true
  16: |
    apiVersion: helm.toolkit.fluxcd.io/v2
    kind: HelmRelease
    metadata:
      name: traefik-crds
    spec:
      chart:
        spec:
          chart: traefik-crds
          reconcileStrategy: ChartVersion
          sourceRef:
            kind: HelmRepository
            name: traefik-crds
      dependsOn: null
      interval: 1m
      releaseName: traefik-crds
      targetNamespace: default
      timeout: 30m
  17: |
    apiVersion: helm.toolkit.fluxcd.io/v2
    kind: HelmRelease
    metadata:
      name: traefik
    spec:
      chart:
        spec:
          chart: traefik
          reconcileStrategy: ChartVersion
          sourceRef:
            kind: HelmRepository
            name: traefik
      dependsOn:
        - name: traefik-crds
      interval: 1m
      releaseName: traefik
      targetNamespace: default
      timeout: 30m
      values:
        experimental:
          kubernetesGateway:
            enabled: true
        gateway:
          enabled: false
        gatewayClass:
          enabled: true
        ports:
          websecure:
            exposedPort: 8443
            nodePort: 31000
        providers:
          kubernetesGateway:
            enabled: true
            experimentalChannel: true
        service:
          spec:
            clusterIP: 10.96.188.4
          type: NodePort
  18: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      labels:
        artifact: chart
        repo: helm
      name: traefik-crds
    spec:
      componentRef:
        name: platform-mesh
      interval: 3m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: traefik
          resource:
            name: crds
      skipVerify: true
  19: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      annotations:
        artifact: image
        for: traefik
        repo: oci
      name: traefik-image
      namespace: default
    spec:
      componentRef:
        name: platform-mesh
      interval: 3m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: traefik
          resource:
            name: image
      skipVerify: true
  20: |
    apiVersion: delivery.ocm.software/v1alpha1
    kind: Resource
    metadata:
      labels:
        artifact: chart
        repo: helm
      name: traefik
    spec:
      componentRef:
        name: platform-mesh
      interval: 3m
      ocmConfig:
        - apiVersion: delivery.ocm.software/v1alpha1
          kind: Repository
          name: platform-mesh
          namespace: default
      resource:
        byReference:
          referencePath:
            - name: traefik
          resource:
            name: chart
      skipVerify: true
