apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
  - ../../components/platform-mesh-operator-resource
  - ../../components/example-httpbin-provider

patches:
  - target:
      kind: PlatformMesh
      name: platform-mesh
      namespace: platform-mesh-system
    patch: |-
      - op: replace
        path: /spec/kcp
        value: {}
      - op: replace
        path: /spec/kcp/extraProviderConnections
        value: [ { endpointSliceName: "", path: root:providers:httpbin-provider, secret: httpbin-kubeconfig, namespace: example-httpbin-provider, external: false }]
      - op: replace
        path: /spec/kcp/extraDefaultAPIBindings
        value: [ { workspaceTypePath: root:account, export: orchestrate.platform-mesh.io, path: root:providers:httpbin-provider }]
